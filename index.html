<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0"/>
  <title>DiNGo â€” Live Multiplayer Bingo</title>
  <link href="https://fonts.googleapis.com/css2?family=Bebas+Neue&family=Plus+Jakarta+Sans:wght@400;500;600;700;800&display=swap" rel="stylesheet"/>
  <style>
  /* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
     DESIGN TOKENS
  â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
  :root {
    --bg:       #06080e;
    --surf:     rgba(13,17,30,0.85);
    --surf2:    rgba(20,26,44,0.9);
    --surf3:    rgba(255,255,255,0.04);
    --border:   rgba(255,255,255,0.08);
    --border2:  rgba(255,255,255,0.14);
    --cyan:     #00e5ff;
    --pink:     #ff3cac;
    --gold:     #ffd166;
    --green:    #06ffa5;
    --purple:   #a78bfa;
    --text:     #e8f0fe;
    --text2:    #8ba3c7;
    --muted:    #3d5070;
    --radius:   18px;
    --radius-sm:10px;
    --gc:       0 0 32px rgba(0,229,255,0.45);
    --gp:       0 0 32px rgba(255,60,172,0.45);
    --gg:       0 0 32px rgba(255,209,102,0.7);
  }
  body.light {
    --bg:    #eef2ff;
    --surf:  rgba(255,255,255,0.88);
    --surf2: rgba(240,244,255,0.95);
    --surf3: rgba(0,0,0,0.03);
    --border:rgba(0,0,0,0.08);
    --border2:rgba(0,0,0,0.14);
    --text:  #0d1b35;
    --text2: #4e6080;
    --muted: #9db0cc;
  }

  /* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
     RESET & BASE
  â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
  *,*::before,*::after{box-sizing:border-box;margin:0;padding:0}
  html,body{width:100%;height:100%;overflow:hidden}
  body{
    font-family:'Plus Jakarta Sans',sans-serif;
    background:var(--bg);
    color:var(--text);
    display:flex;align-items:center;justify-content:center;
    transition:background .5s,color .4s;
  }

  /* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
     ANIMATED BACKGROUND
  â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
  .bg-orbs{position:fixed;inset:0;z-index:0;pointer-events:none;overflow:hidden}
  .orb{
    position:absolute;border-radius:50%;filter:blur(80px);
    animation:orbFloat ease-in-out infinite alternate;
    opacity:.55;
  }
  .orb1{width:500px;height:500px;background:rgba(0,229,255,0.12);top:-10%;left:-10%;animation-duration:18s}
  .orb2{width:400px;height:400px;background:rgba(255,60,172,0.10);bottom:-10%;right:-5%;animation-duration:22s;animation-delay:-6s}
  .orb3{width:300px;height:300px;background:rgba(167,139,250,0.08);top:40%;left:55%;animation-duration:15s;animation-delay:-3s}
  body.light .orb{opacity:.3}
  @keyframes orbFloat{from{transform:translate(0,0) scale(1)}to{transform:translate(3%,4%) scale(1.08)}}

  /* grid dots */
  .bg-grid{
    position:fixed;inset:0;z-index:0;pointer-events:none;
    background-image:radial-gradient(circle,rgba(255,255,255,.025) 1px,transparent 1px);
    background-size:32px 32px;
  }
  body.light .bg-grid{background-image:radial-gradient(circle,rgba(0,0,0,.04) 1px,transparent 1px)}

  /* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
     FLOATING UI CONTROLS (top corners)
  â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
  .ui-pill{
    position:fixed;top:16px;z-index:600;
    display:flex;align-items:center;gap:8px;
    background:var(--surf2);
    border:1px solid var(--border2);
    border-radius:999px;
    padding:6px 14px 6px 10px;
    backdrop-filter:blur(20px);
    box-shadow:0 4px 24px rgba(0,0,0,.35);
    cursor:pointer;
    font-family:inherit;font-size:13px;font-weight:600;
    color:var(--text2);letter-spacing:.3px;
    transition:all .25s cubic-bezier(.4,0,.2,1);
    border:none;
  }
  .ui-pill:hover{color:var(--text);border-color:var(--cyan);box-shadow:0 6px 28px rgba(0,229,255,.25)}
  .ui-pill .icon{font-size:17px;line-height:1}
  #global-home-btn{left:16px;display:none}
  #theme-toggle{right:16px}
  #global-home-btn:hover{border-color:var(--gold)!important;box-shadow:0 6px 28px rgba(255,209,102,.25)!important}

  /* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
     SCREEN SYSTEM â€” cinematic transitions
  â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
  .screen{
    position:fixed;inset:0;
    display:flex;flex-direction:column;align-items:center;justify-content:center;
    padding:16px;
    opacity:0;pointer-events:none;
    transform:translateY(28px) scale(0.96);
    transition:opacity .5s cubic-bezier(.4,0,.2,1),transform .5s cubic-bezier(.4,0,.2,1);
    z-index:10;
  }
  .screen.active{opacity:1;pointer-events:all;transform:translateY(0) scale(1)}
  .screen.exit{opacity:0;transform:translateY(-20px) scale(1.02)}

  /* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
     GLASSMORPHISM CARD
  â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
  .card{
    background:var(--surf);
    border:1px solid var(--border2);
    border-radius:28px;
    width:100%;max-width:440px;
    position:relative;overflow:hidden;
    backdrop-filter:blur(24px);
    box-shadow:0 32px 80px rgba(0,0,0,.55),inset 0 1px 0 rgba(255,255,255,.08);
    transition:background .5s,border-color .4s,box-shadow .4s;
  }
  body.light .card{box-shadow:0 20px 60px rgba(0,0,0,.12),inset 0 1px 0 rgba(255,255,255,.9)}
  /* animated top gradient border */
  .card::before{
    content:'';position:absolute;top:0;left:0;right:0;height:2px;
    background:linear-gradient(90deg,var(--cyan),var(--pink),var(--gold),var(--cyan));
    background-size:200%;
    animation:borderShimmer 4s linear infinite;
  }
  @keyframes borderShimmer{0%{background-position:0%}100%{background-position:200%}}
  .card-body{
    padding:32px 32px 28px;
    overflow-y:auto;max-height:calc(100vh - 52px);
    scrollbar-width:none;
  }
  .card-body::-webkit-scrollbar{display:none}

  /* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
     SPLASH SCREEN
  â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
  #splash-screen{background:var(--bg)}
  #splash-screen .card{
    max-width:500px;text-align:center;
    background:transparent;border:none;box-shadow:none;backdrop-filter:none
  }
  #splash-screen .card::before{display:none}

  .splash-logo-wrap{position:relative;display:inline-block;margin-bottom:16px}
  .splash-logo{
    font-family:'Bebas Neue',sans-serif;
    font-size:clamp(90px,22vw,140px);
    letter-spacing:18px;
    background:linear-gradient(135deg,var(--cyan) 0%,var(--pink) 55%,var(--gold) 100%);
    -webkit-background-clip:text;-webkit-text-fill-color:transparent;background-clip:text;
    display:block;line-height:1;
    animation:logoIn 1.1s cubic-bezier(.17,.67,.35,1.4) both,logoPulse 5s ease-in-out 1.1s infinite;
  }
  @keyframes logoIn{0%{opacity:0;transform:scale(.4) translateY(50px);letter-spacing:0}100%{opacity:1;transform:scale(1) translateY(0)}}
  @keyframes logoPulse{
    0%,100%{filter:drop-shadow(0 0 20px rgba(0,229,255,.4))}
    50%{filter:drop-shadow(0 0 55px rgba(255,60,172,.55))}
  }

  /* 3 orbiting rings */
  .splash-ring{
    position:absolute;top:50%;left:50%;border-radius:50%;
    border:1px solid transparent;transform:translate(-50%,-50%);
    pointer-events:none;animation:ringOrbit linear infinite;
  }
  .ring1{width:210px;height:210px;border-color:rgba(0,229,255,.18);animation-duration:7s}
  .ring2{width:280px;height:280px;border-color:rgba(255,60,172,.12);animation-duration:12s;animation-direction:reverse}
  .ring3{width:340px;height:340px;border-color:rgba(255,209,102,.07);animation-duration:20s}
  .splash-ring::after{
    content:'';position:absolute;top:-5px;left:calc(50% - 5px);
    width:10px;height:10px;border-radius:50%;
  }
  .ring1::after{background:var(--cyan);box-shadow:var(--gc)}
  .ring2::after{background:var(--pink);box-shadow:var(--gp)}
  .ring3::after{background:var(--gold);box-shadow:var(--gg)}
  @keyframes ringOrbit{from{transform:translate(-50%,-50%) rotate(0)}to{transform:translate(-50%,-50%) rotate(360deg)}}

  .splash-tagline{
    font-size:11px;letter-spacing:5px;text-transform:uppercase;
    color:var(--text2);margin-bottom:10px;animation:fadeUp .8s .4s both;
  }
  .splash-desc{
    font-size:15px;color:var(--text2);line-height:1.75;
    margin-bottom:44px;max-width:340px;margin-inline:auto;
    animation:fadeUp .8s .6s both;
  }

  /* Particles */
  .particles{position:fixed;inset:0;pointer-events:none;z-index:5}
  .particle{position:absolute;border-radius:50%;animation:floatUp linear infinite;opacity:0}
  @keyframes floatUp{
    0%{opacity:0;transform:translateY(0) scale(0)}
    10%{opacity:.9}90%{opacity:.4}
    100%{opacity:0;transform:translateY(-110vh) scale(2)}
  }
  @keyframes fadeUp{from{opacity:0;transform:translateY(18px)}to{opacity:1;transform:translateY(0)}}

  /* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
     BUTTONS â€” animated, modern
  â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
  .btn{
    display:inline-flex;align-items:center;justify-content:center;gap:8px;
    border:none;outline:none;cursor:pointer;
    font-family:'Plus Jakarta Sans',sans-serif;font-weight:700;
    font-size:13px;letter-spacing:.8px;text-transform:uppercase;
    border-radius:var(--radius-sm);padding:13px 22px;
    transition:transform .2s cubic-bezier(.4,0,.2,1),box-shadow .25s,opacity .15s,filter .2s;
    position:relative;overflow:hidden;
  }
  /* shimmer sweep on hover */
  .btn::before{
    content:'';position:absolute;inset:0;
    background:linear-gradient(105deg,transparent 35%,rgba(255,255,255,.2) 50%,transparent 65%);
    transform:translateX(-100%);transition:transform .5s ease;
  }
  .btn:hover::before{transform:translateX(100%)}
  .btn:active{transform:scale(0.95)!important}
  .btn:disabled{opacity:.3;cursor:not-allowed;transform:none!important;filter:none!important}
  .btn-full{width:100%}

  .btn-primary{
    background:linear-gradient(135deg,var(--cyan) 0%,#0090cc 100%);
    color:#000;font-weight:800;
    box-shadow:0 4px 20px rgba(0,229,255,.3),inset 0 1px 0 rgba(255,255,255,.25);
  }
  .btn-primary:hover{box-shadow:0 8px 32px rgba(0,229,255,.5);transform:translateY(-2px)}

  .btn-pink{
    background:linear-gradient(135deg,var(--pink) 0%,#8b00ff 100%);
    color:#fff;font-weight:800;
    box-shadow:0 4px 20px rgba(255,60,172,.3),inset 0 1px 0 rgba(255,255,255,.15);
  }
  .btn-pink:hover{box-shadow:0 8px 32px rgba(255,60,172,.5);transform:translateY(-2px)}

  .btn-gold{
    background:linear-gradient(135deg,var(--gold) 0%,#ff8c00 100%);
    color:#000;font-weight:800;
    box-shadow:0 4px 20px rgba(255,209,102,.3),inset 0 1px 0 rgba(255,255,255,.25);
  }
  .btn-gold:hover{box-shadow:0 8px 32px rgba(255,209,102,.5);transform:translateY(-2px)}

  .btn-ghost{
    background:var(--surf3);border:1px solid var(--border2);
    color:var(--text2);font-weight:600;
    transition:all .2s;
  }
  .btn-ghost:hover{border-color:var(--cyan);color:var(--text);background:rgba(0,229,255,.07)}

  /* The big arena button with animated gradient border */
  .btn-arena{
    padding:18px 52px;font-size:15px;letter-spacing:2.5px;
    background:linear-gradient(135deg,var(--cyan),var(--pink));
    color:#fff;font-weight:800;border-radius:16px;
    box-shadow:0 10px 48px rgba(0,229,255,.4),inset 0 1px 0 rgba(255,255,255,.15);
    animation:fadeUp .8s .9s both,arenaPulse 3.5s ease-in-out 1.7s infinite;
    width:100%;max-width:300px;font-size:14px;
  }
  @keyframes arenaPulse{
    0%,100%{box-shadow:0 10px 48px rgba(0,229,255,.4)}
    50%{box-shadow:0 12px 64px rgba(255,60,172,.6)}
  }

  /* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
     FORM ELEMENTS
  â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
  .field-label{
    font-size:11px;letter-spacing:2px;text-transform:uppercase;
    color:var(--text2);margin-bottom:8px;display:block;font-weight:600;
  }
  input[type="text"]{
    width:100%;background:var(--surf3);
    border:1px solid var(--border);border-radius:var(--radius-sm);
    padding:13px 16px;color:var(--text);
    font-family:'Plus Jakarta Sans',sans-serif;font-size:15px;
    outline:none;transition:border-color .2s,box-shadow .2s,background .4s;
  }
  input[type="text"]::placeholder{color:var(--muted);font-size:14px}
  input[type="text"]:focus{
    border-color:var(--cyan);
    box-shadow:0 0 0 3px rgba(0,229,255,.12),0 0 20px rgba(0,229,255,.08);
  }
  body.light input[type="text"]{background:rgba(0,0,0,.04)}

  .divider{
    display:flex;align-items:center;gap:10px;
    color:var(--muted);font-size:11px;letter-spacing:2px;text-transform:uppercase;
    margin:18px 0;font-weight:600;
  }
  .divider::before,.divider::after{content:'';flex:1;height:1px;background:var(--border)}

  /* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
     SCREEN HEADER (name-logo reusable)
  â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
  .screen-logo{
    font-family:'Bebas Neue',sans-serif;font-size:36px;letter-spacing:8px;
    background:linear-gradient(90deg,var(--cyan),var(--pink));
    -webkit-background-clip:text;-webkit-text-fill-color:transparent;background-clip:text;
    text-align:center;margin-bottom:4px;
  }
  .screen-sub{
    text-align:center;font-size:11px;letter-spacing:3px;text-transform:uppercase;
    color:var(--text2);margin-bottom:28px;font-weight:600;
  }

  /* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
     AVATAR + COLOR PICKERS
  â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
  .avatar-grid{
    display:grid;grid-template-columns:repeat(6,1fr);gap:8px;
    margin-bottom:20px;
  }
  .avatar-opt{
    font-size:24px;aspect-ratio:1;border-radius:12px;
    border:2px solid var(--border);background:var(--surf3);
    display:flex;align-items:center;justify-content:center;
    cursor:pointer;
    transition:border-color .2s,transform .2s cubic-bezier(.4,0,.2,1),box-shadow .2s,background .2s;
  }
  .avatar-opt:hover{transform:scale(1.12) rotate(-3deg);border-color:rgba(0,229,255,.5)}
  .avatar-opt.selected{
    border-color:var(--cyan);
    box-shadow:0 0 18px rgba(0,229,255,.45);
    background:rgba(0,229,255,.1);
    transform:scale(1.08);
  }

  .color-strip{display:flex;gap:8px;justify-content:center;margin-bottom:22px}
  .color-swatch{
    width:28px;height:28px;border-radius:50%;cursor:pointer;
    border:3px solid transparent;
    transition:transform .2s cubic-bezier(.4,0,.2,1),border-color .2s,box-shadow .2s;
  }
  .color-swatch:hover{transform:scale(1.2)}
  .color-swatch.selected{border-color:#fff;box-shadow:0 0 16px rgba(255,255,255,.5);transform:scale(1.22)}
  body.light .color-swatch.selected{border-color:#111}

  /* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
     HOME / LOBBY SCREEN  
  â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
  .join-row{display:flex;gap:8px;margin-top:4px}
  .join-row input{flex:1;letter-spacing:4px;text-transform:uppercase}
  #home-msg{
    min-height:18px;font-size:13px;font-weight:600;
    text-align:center;margin-top:14px;
    color:var(--pink);animation:fadeUp .3s ease;
  }

  /* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
     ROOM BADGE (setup screen)
  â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
  .room-badge{
    background:rgba(0,229,255,.05);
    border:1px solid rgba(0,229,255,.2);
    border-radius:16px;padding:14px 18px;margin-bottom:20px;
    display:flex;align-items:center;justify-content:space-between;gap:12px;
    backdrop-filter:blur(8px);
  }
  .room-badge-label{font-size:10px;letter-spacing:2px;text-transform:uppercase;color:var(--text2);margin-bottom:4px;font-weight:600}
  .room-badge-code{
    font-family:'Bebas Neue',sans-serif;font-size:32px;letter-spacing:10px;
    color:var(--cyan);text-shadow:var(--gc);
  }
  .waiting-dots{display:flex;align-items:center;gap:5px;font-size:12px;color:var(--text2)}
  .dot{width:5px;height:5px;border-radius:50%;background:var(--cyan);animation:blink 1.2s ease-in-out infinite}
  .dot:nth-child(2){animation-delay:.2s}.dot:nth-child(3){animation-delay:.4s}
  @keyframes blink{0%,100%{opacity:.2;transform:scale(.8)}50%{opacity:1;transform:scale(1.2)}}

  /* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
     SETUP BOARD
  â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
  .section-title{font-family:'Bebas Neue',sans-serif;font-size:22px;letter-spacing:3px;margin-bottom:4px}
  .section-sub{font-size:12px;color:var(--text2);margin-bottom:14px;line-height:1.55}
  .progress-bar{height:3px;background:var(--border);border-radius:999px;overflow:hidden;margin-bottom:14px}
  .progress-fill{height:100%;background:linear-gradient(90deg,var(--cyan),var(--pink));width:0%;transition:width .3s ease;border-radius:999px}
  .setup-actions{display:flex;gap:8px;margin-bottom:12px}
  .setup-actions .btn{flex:1;font-size:11px;padding:10px 6px}

  /* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
     BINGO BOARD â€” game cells
  â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
  .board-wrap{display:flex;justify-content:center;margin-bottom:14px}
  .board{
    display:grid;grid-template-columns:repeat(5,1fr);gap:6px;
    width:min(100%,min(calc(100vw - 64px),calc(100vh - 340px)));
  }
  .cell{
    border-radius:10px;border:1px solid var(--border);
    background:var(--surf3);
    display:flex;align-items:center;justify-content:center;
    font-family:'Bebas Neue',sans-serif;
    font-size:clamp(14px,3.8vw,22px);
    color:var(--text);cursor:pointer;
    transition:background .2s,border-color .2s,transform .18s cubic-bezier(.4,0,.2,1),box-shadow .2s;
    user-select:none;position:relative;overflow:hidden;aspect-ratio:1;
  }
  /* shimmer on hover */
  .cell::before{
    content:'';position:absolute;inset:0;
    background:linear-gradient(105deg,transparent 35%,rgba(255,255,255,.12) 50%,transparent 65%);
    transform:translateX(-100%);transition:transform .4s ease;
  }
  .cell:not(.crossed):not([data-filled]):hover::before{transform:translateX(100%)}

  #setup-board .cell:not([data-filled]):hover{
    background:rgba(0,229,255,.08);border-color:rgba(0,229,255,.4);transform:scale(1.07)
  }
  #setup-board .cell[data-filled]{
    background:rgba(0,229,255,.1);border-color:rgba(0,229,255,.35);
    color:var(--cyan);animation:cellPop .3s cubic-bezier(.17,.67,.35,1.4);
  }
  @keyframes cellPop{0%{transform:scale(.6);opacity:0}100%{transform:scale(1);opacity:1}}

  #game-board .cell:not(.crossed):hover{
    background:rgba(255,209,102,.09);border-color:rgba(255,209,102,.4);transform:scale(1.08)
  }
  .cell.crossed{
    background:linear-gradient(135deg,rgba(0,229,255,.2),rgba(255,60,172,.2));
    border-color:var(--cyan);cursor:default;
    animation:crossPop .4s cubic-bezier(.17,.67,.35,1.4);
  }
  .cell.crossed::after{
    content:'âœ•';position:absolute;inset:0;
    display:flex;align-items:center;justify-content:center;
    color:var(--cyan);font-size:1.4em;opacity:.55;text-shadow:var(--gc)
  }
  @keyframes crossPop{0%{transform:scale(1.4)}60%{transform:scale(.88)}100%{transform:scale(1)}}

  /* WIN LINE â€” golden pulse */
  .cell.win-line{
    background:linear-gradient(135deg,rgba(255,209,102,.3),rgba(255,140,0,.22))!important;
    border-color:var(--gold)!important;
    animation:winLinePulse 1.3s ease-in-out infinite!important;
    box-shadow:0 0 20px rgba(255,209,102,.6)!important;
    color:var(--gold)!important;z-index:2;
  }
  .cell.win-line::after{color:var(--gold)!important;text-shadow:0 0 14px rgba(255,209,102,.8)!important}
  @keyframes winLinePulse{
    0%,100%{box-shadow:0 0 12px rgba(255,209,102,.5)}
    50%{box-shadow:0 0 36px rgba(255,209,102,1),0 0 60px rgba(255,140,0,.4)}
  }

  /* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
     GAME SCREEN LAYOUT
  â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
  #game-screen .card{max-width:520px}
  #game-screen .card-body{padding:18px 18px 16px}

  /* Score bar */
  .score-bar{
    display:flex;align-items:center;justify-content:center;gap:12px;
    margin-bottom:10px;
  }
  .score-chip{
    display:flex;flex-direction:column;align-items:center;
    background:var(--surf3);border:1px solid var(--border);
    border-radius:12px;padding:6px 20px;min-width:64px;
  }
  .score-num{font-family:'Bebas Neue',sans-serif;font-size:30px;letter-spacing:2px;line-height:1}
  .score-num.c1{color:var(--cyan)}.score-num.c2{color:var(--pink)}
  .score-lbl{font-size:9px;color:var(--text2);letter-spacing:1.5px;text-transform:uppercase;margin-top:2px;font-weight:600}
  .vs-dot{font-family:'Bebas Neue',sans-serif;font-size:16px;color:var(--muted);letter-spacing:2px}

  /* Player info boxes */
  .players-row{display:flex;justify-content:space-between;align-items:stretch;gap:8px;margin-bottom:10px}
  .player-box{
    display:flex;align-items:center;gap:8px;
    background:var(--surf2);border:1px solid var(--border);
    border-radius:14px;padding:8px 12px;
    flex:1;min-width:0;
    transition:border-color .3s,box-shadow .3s,background .4s;
    position:relative;overflow:hidden;
  }
  .player-box.p2{flex-direction:row-reverse;text-align:right}
  .player-box.active-turn{
    border-color:var(--gold)!important;
    box-shadow:0 0 18px rgba(255,209,102,.28);
  }
  /* pulsing left/right accent bar when it's your turn */
  .player-box::after{
    content:'';position:absolute;top:0;bottom:0;width:2px;
    background:linear-gradient(180deg,var(--cyan),var(--pink));
    opacity:0;transition:opacity .3s;
  }
  .player-box.p1::after{left:0}
  .player-box.p2::after{right:0}
  .player-box.active-turn::after{opacity:1}
  .player-avatar{font-size:20px;flex-shrink:0}
  .player-info{flex:1;min-width:0}
  .player-label{font-size:9px;color:var(--text2);letter-spacing:1.5px;text-transform:uppercase;font-weight:600}
  .player-name{font-size:13px;font-weight:700;overflow:hidden;text-overflow:ellipsis;white-space:nowrap;margin-bottom:2px}

  /* â”€â”€ PLAYER STATUS â€” last message shown inline â”€â”€ */
  .player-status{
    font-size:11px;color:var(--text2);
    white-space:nowrap;overflow:hidden;text-overflow:ellipsis;
    max-width:100%;font-style:italic;
    opacity:0;
    animation:none;
    transition:opacity .3s;
    height:14px;line-height:14px;
  }
  .player-status.visible{opacity:1}

  .vs-badge{font-family:'Bebas Neue',sans-serif;font-size:15px;color:var(--muted);flex-shrink:0;letter-spacing:2px}

  /* Turn indicator */
  #turn-indicator{
    font-family:'Bebas Neue',sans-serif;
    font-size:clamp(15px,4vw,20px);
    letter-spacing:3px;text-align:center;
    margin-bottom:10px;min-height:26px;transition:color .3s;
  }

  /* Action row */
  .action-row{display:flex;gap:8px;margin-top:12px}
  .action-row .btn{flex:1;font-size:11px;padding:10px 6px}

  /* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
     NUMBER ANNOUNCEMENT OVERLAY
  â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
  #number-announce{position:fixed;inset:0;z-index:150;display:flex;align-items:center;justify-content:center;pointer-events:none}
  .announce-bubble{
    background:var(--surf);border:2px solid var(--gold);
    border-radius:28px;padding:22px 48px;text-align:center;
    box-shadow:0 0 50px rgba(255,209,102,.4),0 24px 70px rgba(0,0,0,.65);
    backdrop-filter:blur(20px);
    transform:scale(0) translateY(20px);opacity:0;transition:none;
  }
  .announce-bubble.pop{animation:annPop .6s cubic-bezier(.17,.67,.35,1.4) forwards}
  .announce-bubble.fade-out{animation:annFade .35s ease forwards}
  @keyframes annPop{0%{transform:scale(.25) translateY(30px);opacity:0}60%{transform:scale(1.1) translateY(-6px);opacity:1}100%{transform:scale(1) translateY(0);opacity:1}}
  @keyframes annFade{0%{transform:scale(1);opacity:1}100%{transform:scale(.7) translateY(-22px);opacity:0}}
  .announce-who{font-size:10px;letter-spacing:3.5px;text-transform:uppercase;color:var(--gold);margin-bottom:4px;font-weight:700}
  .announce-num{
    font-family:'Bebas Neue',sans-serif;font-size:clamp(64px,18vw,108px);
    letter-spacing:6px;line-height:1;
    background:linear-gradient(135deg,var(--gold),var(--pink));
    -webkit-background-clip:text;-webkit-text-fill-color:transparent;background-clip:text;
  }
  .announce-sub{font-size:12px;color:var(--text2);letter-spacing:2px;margin-top:4px;font-weight:500}

  /* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
     WIN OVERLAY
  â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
  #win-overlay{
    position:fixed;inset:0;z-index:200;
    display:flex;flex-direction:column;align-items:center;justify-content:center;
    background:rgba(6,8,14,.9);backdrop-filter:blur(12px);
    opacity:0;pointer-events:none;transition:opacity .45s;padding:24px;
  }
  body.light #win-overlay{background:rgba(240,244,255,.92)}
  #win-overlay.show{opacity:1;pointer-events:all}
  .win-title{
    font-family:'Bebas Neue',sans-serif;
    font-size:clamp(64px,18vw,108px);
    letter-spacing:10px;line-height:1;
    background:linear-gradient(135deg,var(--gold),var(--pink));
    -webkit-background-clip:text;-webkit-text-fill-color:transparent;background-clip:text;
    animation:winBounce 1s cubic-bezier(.17,.67,.35,1.4) both;text-align:center;
  }
  @keyframes winBounce{0%{transform:scale(0) rotate(-15deg);opacity:0}60%{transform:scale(1.15) rotate(3deg)}80%{transform:scale(.95) rotate(-1deg)}100%{transform:scale(1) rotate(0);opacity:1}}
  .win-subtitle{
    font-size:15px;color:var(--text2);margin-top:8px;margin-bottom:36px;
    letter-spacing:2px;text-align:center;animation:fadeUp .6s .4s both;
  }
  .win-buttons{display:flex;gap:12px;flex-wrap:wrap;justify-content:center;animation:fadeUp .6s .6s both}
  .rematch-countdown{font-size:13px;color:var(--text2);letter-spacing:2px;margin-top:16px;text-align:center;animation:fadeUp .5s .8s both}
  .rematch-countdown strong{color:var(--gold);font-size:16px}
  .countdown-cancel{
    background:none;border:none;cursor:pointer;
    color:var(--muted);font-size:11px;letter-spacing:1px;text-transform:uppercase;
    text-decoration:underline;font-family:inherit;margin-top:6px;padding:2px 6px;
  }
  .countdown-cancel:hover{color:var(--text)}
  #confetti-canvas{position:fixed;inset:0;pointer-events:none;z-index:199}

  /* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
     CHAT FAB + PANEL
  â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
  .chat-fab{
    position:fixed;bottom:24px;right:24px;
    width:54px;height:54px;border-radius:50%;
    background:linear-gradient(135deg,var(--cyan),var(--pink));
    border:none;cursor:pointer;
    display:flex;align-items:center;justify-content:center;
    font-size:22px;
    box-shadow:0 6px 28px rgba(0,229,255,.45);
    z-index:100;transition:transform .25s cubic-bezier(.4,0,.2,1),box-shadow .25s;
    animation:fabPop .5s cubic-bezier(.17,.67,.35,1.4);
  }
  .chat-fab:hover{transform:scale(1.12) rotate(-5deg);box-shadow:0 8px 36px rgba(255,60,172,.55)}
  @keyframes fabPop{from{transform:scale(0);opacity:0}to{transform:scale(1);opacity:1}}
  .chat-badge{
    position:absolute;top:-3px;right:-3px;
    width:16px;height:16px;border-radius:50%;
    background:var(--gold);border:2px solid var(--bg);
    animation:badgePop .3s cubic-bezier(.17,.67,.35,1.4);
    display:none;
  }
  .chat-badge.show{display:block}
  @keyframes badgePop{from{transform:scale(0)}to{transform:scale(1)}}

  .chat-panel{
    position:fixed;bottom:90px;right:24px;width:310px;
    background:var(--surf);border:1px solid var(--border2);
    border-radius:24px;
    box-shadow:0 24px 70px rgba(0,0,0,.65),inset 0 1px 0 rgba(255,255,255,.07);
    z-index:99;display:flex;flex-direction:column;overflow:hidden;
    transform:scale(.85) translateY(22px);transform-origin:bottom right;
    opacity:0;pointer-events:none;
    transition:transform .28s cubic-bezier(.4,0,.2,1),opacity .28s;
    backdrop-filter:blur(24px);
  }
  .chat-panel.open{transform:scale(1) translateY(0);opacity:1;pointer-events:all}
  .chat-panel::before{content:'';position:absolute;top:0;left:0;right:0;height:2px;background:linear-gradient(90deg,var(--cyan),var(--pink))}
  .chat-header{
    padding:14px 16px 10px;font-size:11px;letter-spacing:2px;text-transform:uppercase;
    color:var(--text2);border-bottom:1px solid var(--border);font-weight:700;
  }
  .chat-messages{
    flex:1;overflow-y:auto;padding:10px 12px;
    display:flex;flex-direction:column;gap:8px;max-height:210px;
    scrollbar-width:thin;scrollbar-color:var(--border) transparent;
  }
  .chat-msg{display:flex;flex-direction:column;gap:3px}
  .chat-msg.mine{align-items:flex-end}
  .chat-bubble{
    display:inline-block;padding:7px 12px;border-radius:12px;
    font-size:13px;max-width:210px;word-break:break-word;line-height:1.5;
    background:var(--surf2);border:1px solid var(--border);
    animation:bubblePop .25s cubic-bezier(.17,.67,.35,1.4);
  }
  .chat-bubble.emoji-only{font-size:24px;padding:6px 10px;background:var(--surf2)}
  .chat-msg.mine .chat-bubble{background:rgba(0,229,255,.1);border-color:rgba(0,229,255,.22)}
  .chat-sender{font-size:10px;color:var(--muted);letter-spacing:.5px;font-weight:600}
  @keyframes bubblePop{from{transform:scale(.55);opacity:0}to{transform:scale(1);opacity:1}}
  .chat-emojis{display:flex;flex-wrap:wrap;gap:6px;padding:8px 12px;border-top:1px solid var(--border)}
  .emoji-btn{
    font-size:18px;width:34px;height:34px;border-radius:9px;
    background:var(--surf3);border:1px solid var(--border);
    cursor:pointer;display:flex;align-items:center;justify-content:center;
    transition:transform .15s,border-color .15s,background .15s;
  }
  .emoji-btn:hover{transform:scale(1.25) rotate(-5deg);border-color:var(--cyan);background:rgba(0,229,255,.08)}
  .chat-input-row{display:flex;gap:6px;padding:8px 12px;border-top:1px solid var(--border)}
  .chat-text-input{
    flex:1;background:var(--surf3);border:1px solid var(--border);
    border-radius:9px;padding:8px 11px;color:var(--text);
    font-family:inherit;font-size:13px;outline:none;
    transition:border-color .2s,box-shadow .2s;
  }
  .chat-text-input:focus{border-color:var(--cyan);box-shadow:0 0 0 2px rgba(0,229,255,.1)}
  .chat-text-input::placeholder{color:var(--muted);font-size:12px}
  .chat-send-btn{
    width:36px;height:36px;border-radius:9px;border:none;
    background:linear-gradient(135deg,var(--cyan),var(--pink));
    cursor:pointer;display:flex;align-items:center;justify-content:center;
    font-size:15px;flex-shrink:0;
    transition:transform .18s,box-shadow .18s;
  }
  .chat-send-btn:hover{transform:scale(1.1);box-shadow:0 4px 16px rgba(0,229,255,.4)}
  </style>
</head>
<body>

<div class="bg-orbs">
  <div class="orb orb1"></div>
  <div class="orb orb2"></div>
  <div class="orb orb3"></div>
</div>
<div class="bg-grid"></div>
<div class="particles" id="particles"></div>
<canvas id="confetti-canvas"></canvas>

<!-- Top UI controls -->
<button class="ui-pill" id="global-home-btn"><span class="icon">ğŸ </span> Home</button>
<button class="ui-pill" id="theme-toggle"><span class="icon">ğŸŒ™</span> Theme</button>

<!-- Number Announcement -->
<div id="number-announce">
  <div class="announce-bubble" id="announce-bubble">
    <div class="announce-who" id="announce-who">CALLED</div>
    <div class="announce-num" id="announce-num">â€”</div>
    <div class="announce-sub" id="announce-sub">picks this number</div>
  </div>
</div>

<!-- Win Overlay -->
<div id="win-overlay">
  <div class="win-title" id="win-title-text">YOU WIN!</div>
  <div class="win-subtitle" id="win-subtitle-text">Incredible performance ğŸ¯</div>
  <div class="win-buttons">
    <button class="btn btn-gold" id="win-restart-btn">â†º &nbsp;Restart Match</button>
    <button class="btn btn-ghost" id="win-reset-btn">â &nbsp;Exit</button>
  </div>
  <div class="rematch-countdown" id="rematch-countdown" style="display:none;">
    Auto-rematch in <strong id="countdown-val">10</strong>s
    <br><button class="countdown-cancel" id="countdown-cancel">Cancel</button>
  </div>
</div>


<!-- â‘  SPLASH -->
<div id="splash-screen" class="screen active">
  <div class="card">
    <div class="card-body" style="text-align:center;padding:52px 36px 56px">
      <div class="splash-logo-wrap">
        <div class="splash-ring ring1"></div>
        <div class="splash-ring ring2"></div>
        <div class="splash-ring ring3"></div>
        <span class="splash-logo">DiNGo</span>
      </div>
      <p class="splash-tagline">Real-time Multiplayer</p>
      <p class="splash-desc">Place your numbers. Call the shots.<br>First to 5 lines claims the arena.</p>
      <button class="btn btn-arena" id="enter-arena-btn">âš¡ &nbsp;Enter the Arena</button>
    </div>
  </div>
</div>


<!-- â‘¡ NAME ENTRY -->
<div id="name-screen" class="screen">
  <div class="card">
    <div class="card-body">
      <div class="screen-logo">DiNGo</div>
      <p class="screen-sub">Choose your identity</p>

      <p class="field-label">Pick an avatar</p>
      <div class="avatar-grid" id="avatar-row"></div>

      <p class="field-label">Pick your colour</p>
      <div class="color-strip" id="color-row"></div>

      <p class="field-label">Your name</p>
      <input type="text" id="player-name-input" maxlength="14" placeholder="e.g. Nova, Ace, Zaraâ€¦" style="margin-bottom:20px"/>

      <button class="btn btn-primary btn-full" id="name-confirm-btn">â†’ &nbsp;Continue to Lobby</button>
    </div>
  </div>
</div>


<!-- â‘¢ HOME / LOBBY -->
<div id="home-screen" class="screen">
  <div class="card">
    <div class="card-body">
      <div class="screen-logo">DiNGo</div>
      <p class="screen-sub">Multiplayer Â· Live</p>

      <button id="create-btn" class="btn btn-primary btn-full">ï¼‹ &nbsp;Create Room</button>
      <div class="divider">or join existing</div>
      <div class="join-row">
        <input id="room-code-input" type="text" maxlength="4" placeholder="Room code e.g. A3K9"/>
        <button id="join-btn" class="btn btn-ghost">Join</button>
      </div>
      <p id="home-msg"></p>
    </div>
  </div>
</div>


<!-- â‘£ SETUP -->
<div id="setup-screen" class="screen">
  <div class="card">
    <div class="card-body">
      <div class="room-badge">
        <div>
          <div class="room-badge-label">Room Code</div>
          <div class="room-badge-code" id="display-room-code">â€”â€”</div>
          <div class="waiting-dots">
            <span class="dot"></span><span class="dot"></span><span class="dot"></span>
            <span id="waiting-label">Waiting for opponent</span>
          </div>
        </div>
      </div>
      <div class="section-title">Arrange Your Board</div>
      <p class="section-sub">Tap cells to place 1â†’25 in any order, or shuffle randomly.</p>
      <div class="progress-bar"><div class="progress-fill" id="setup-progress"></div></div>
      <div class="setup-actions">
        <button class="btn btn-ghost" id="home-from-setup">ğŸ  Home</button>
        <button class="btn btn-ghost" id="shuffle-btn">ğŸ”€ Random</button>
        <button class="btn btn-ghost" id="clear-btn">âœ• Clear</button>
      </div>
      <div class="board-wrap"><div class="board" id="setup-board"></div></div>
      <button id="ready-btn" class="btn btn-pink btn-full" disabled>âœ“ &nbsp;I'm Ready!</button>
    </div>
  </div>
</div>


<!-- â‘¤ GAME -->
<div id="game-screen" class="screen">
  <div class="card">
    <div class="card-body">

      <!-- Score bar -->
      <div class="score-bar">
        <div class="score-chip">
          <div class="score-num c1" id="score-p1">0</div>
          <div class="score-lbl">P1 Wins</div>
        </div>
        <div class="vs-dot">:</div>
        <div class="score-chip">
          <div class="score-num c2" id="score-p2">0</div>
          <div class="score-lbl">P2 Wins</div>
        </div>
      </div>

      <!-- Player boxes with live status message -->
      <div class="players-row">
        <div class="player-box p1" id="p1-box">
          <span class="player-avatar" id="p1-avatar">ğŸ®</span>
          <div class="player-info">
            <div class="player-label">Player 1</div>
            <div class="player-name" id="p1-name">â€”</div>
            <div class="player-status" id="p1-status"></div>
          </div>
        </div>
        <div class="vs-badge">VS</div>
        <div class="player-box p2" id="p2-box">
          <span class="player-avatar" id="p2-avatar">ğŸ•¹ï¸</span>
          <div class="player-info" style="text-align:right">
            <div class="player-label">Player 2</div>
            <div class="player-name" id="p2-name">â€”</div>
            <div class="player-status" id="p2-status"></div>
          </div>
        </div>
      </div>

      <div id="turn-indicator">Loadingâ€¦</div>

      <div class="board-wrap"><div class="board" id="game-board"></div></div>

      <div class="action-row">
        <button class="btn btn-ghost" id="home-from-game">ğŸ  Home</button>
        <button class="btn btn-gold" id="restart-btn">â†º Restart</button>
        <button class="btn btn-ghost" id="reset-btn">â Exit</button>
      </div>
    </div>
  </div>
</div>


<!-- CHAT FAB + PANEL -->
<button class="chat-fab" id="chat-fab" style="display:none;">
  ğŸ’¬
  <div class="chat-badge" id="chat-badge"></div>
</button>
<div class="chat-panel" id="chat-panel">
  <div class="chat-header">ğŸ’¬ &nbsp;Chat</div>
  <div class="chat-messages" id="chat-messages"></div>
  <div class="chat-emojis" id="chat-emojis"></div>
  <div class="chat-input-row">
    <input type="text" class="chat-text-input" id="chat-text-input" placeholder="Type a messageâ€¦" maxlength="80"/>
    <button class="chat-send-btn" id="chat-send-btn">â¤</button>
  </div>
</div>


<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
     PLAIN SCRIPT â€” instant UI, no Firebase dependency
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<script>
/* â”€â”€ Screen transitions â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
function showScreen(name) {
  document.querySelectorAll('.screen').forEach(s => s.classList.remove('active'));
  document.getElementById(name + '-screen').classList.add('active');
  // Global home pill hidden on splash (you're already there)
  document.getElementById('global-home-btn').style.display =
    (name === 'splash') ? 'none' : 'flex';
}

/* â”€â”€ Theme toggle â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
let isLight = false;
document.getElementById('theme-toggle').addEventListener('click', () => {
  isLight = !isLight;
  document.body.classList.toggle('light', isLight);
  document.getElementById('theme-toggle').innerHTML =
    isLight ? '<span class="icon">â˜€ï¸</span> Theme' : '<span class="icon">ğŸŒ™</span> Theme';
});

/* â”€â”€ Global home pill â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
document.getElementById('global-home-btn').addEventListener('click', () => {
  showScreen('splash');
  document.getElementById('chat-fab').style.display = 'none';
  document.getElementById('chat-panel').classList.remove('open');
  document.getElementById('win-overlay').classList.remove('show');
});

/* â”€â”€ In-card home buttons â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
document.getElementById('home-from-setup').addEventListener('click', () => {
  showScreen('splash');
  document.getElementById('chat-fab').style.display = 'none';
  document.getElementById('chat-panel').classList.remove('open');
});
document.getElementById('home-from-game').addEventListener('click', () => {
  showScreen('splash');
  document.getElementById('chat-fab').style.display = 'none';
  document.getElementById('chat-panel').classList.remove('open');
  document.getElementById('win-overlay').classList.remove('show');
});

/* â”€â”€ Enter arena â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
document.getElementById('enter-arena-btn').addEventListener('click', () => showScreen('name'));

/* â”€â”€ Floating particles â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
(function spawnParticles() {
  const c = document.getElementById('particles');
  const cols = ['#00e5ff','#ff3cac','#ffd166','#06ffa5','#a78bfa'];
  for (let i = 0; i < 32; i++) {
    const p = document.createElement('div');
    p.className = 'particle';
    const sz = 2 + Math.random() * 5;
    p.style.cssText = `left:${Math.random()*100}%;bottom:-10px;width:${sz}px;height:${sz}px;background:${cols[Math.floor(Math.random()*cols.length)]};animation-duration:${7+Math.random()*11}s;animation-delay:${Math.random()*10}s;`;
    c.appendChild(p);
  }
})();

/* â”€â”€ Shared player data (read by Firebase module script) â”€â”€â”€â”€â”€â”€â”€ */
window.DINGO = { selectedAvatar:'ğŸ‘¹', selectedColor:'#00e5ff', playerName:'Player' };

const AVATARS = ['ğŸ‘¹','ğŸ˜˜','ğŸ¦Š','ğŸ‰','ğŸ‘¾','ğŸ¤–','ğŸ¦‹','ğŸ”¥','âš¡','ğŸŒ™','ğŸ’','ğŸ¯'];
const COLORS  = [
  {val:'#00e5ff',label:'Cyan'},{val:'#ff3cac',label:'Pink'},
  {val:'#06ffa5',label:'Green'},{val:'#ffd166',label:'Gold'},
  {val:'#a78bfa',label:'Purple'},{val:'#ff6b6b',label:'Red'},
];

/* Render avatar grid */
const avatarRow = document.getElementById('avatar-row');
AVATARS.forEach((a, i) => {
  const el = document.createElement('div');
  el.className = 'avatar-opt' + (i === 0 ? ' selected' : '');
  el.textContent = a;
  el.addEventListener('click', () => {
    document.querySelectorAll('.avatar-opt').forEach(x => x.classList.remove('selected'));
    el.classList.add('selected');
    window.DINGO.selectedAvatar = a;
  });
  avatarRow.appendChild(el);
});

/* Render colour swatches */
const colorRow = document.getElementById('color-row');
COLORS.forEach((c, i) => {
  const sw = document.createElement('div');
  sw.className = 'color-swatch' + (i === 0 ? ' selected' : '');
  sw.style.background = c.val;
  sw.title = c.label;
  sw.addEventListener('click', () => {
    document.querySelectorAll('.color-swatch').forEach(x => x.classList.remove('selected'));
    sw.classList.add('selected');
    window.DINGO.selectedColor = c.val;
  });
  colorRow.appendChild(sw);
});

/* Continue to lobby */
document.getElementById('name-confirm-btn').addEventListener('click', () => {
  const v = document.getElementById('player-name-input').value.trim();
  window.DINGO.playerName = v || 'Player';
  showScreen('home');
});
document.getElementById('player-name-input').addEventListener('keydown', e => {
  if (e.key === 'Enter') document.getElementById('name-confirm-btn').click();
});
</script>


<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
     FIREBASE MODULE SCRIPT â€” all game logic
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/10.8.1/firebase-app.js";
import { getDatabase, ref, set, get, update, onValue, push }
  from "https://www.gstatic.com/firebasejs/10.8.1/firebase-database.js";

const firebaseConfig = {
  apiKey:            "AIzaSyAhhGzyMUJrfzYsOw4Uy-qu6F_IOqrh3PA",
  authDomain:        "dingo-v2-0.firebaseapp.com",
  databaseURL:       "https://dingo-v2-0-default-rtdb.firebaseio.com",
  projectId:         "dingo-v2-0",
  storageBucket:     "dingo-v2-0.firebasestorage.app",
  messagingSenderId: "908358383631",
  appId:             "1:908358383631:web:09473d12f079a230134b7a",
  measurementId:     "G-MFTX32JEDJ"
};
const app = initializeApp(firebaseConfig);
const db  = getDatabase(app);

/* â”€â”€ Game state â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
let myPlayerId   = Math.random().toString(36).substring(2,9);
let roomId       = "";
let playerRole   = "";
let myBoard      = [];
let setupCounter = 1;
let chatOpen     = false;
let winShown     = false;
let countdownInterval = null;
let scores = { p1:0, p2:0 };
/* Player identity â€” read fresh from window.DINGO at create/join time */
let playerName   = 'Player';
let playerAvatar = 'ğŸ‘¹';
let playerColor  = '#00e5ff';

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   SOUND ENGINE
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
let audioCtx = null;
function getAudio() {
  if (!audioCtx) audioCtx = new (window.AudioContext || window.webkitAudioContext)();
  return audioCtx;
}
function playTone(notes, type='sine', vol=0.18) {
  try {
    const ctx = getAudio();
    notes.forEach(([freq,start,dur]) => {
      const osc=ctx.createOscillator(), gain=ctx.createGain();
      osc.type=type;
      osc.frequency.setValueAtTime(freq, ctx.currentTime+start);
      gain.gain.setValueAtTime(vol, ctx.currentTime+start);
      gain.gain.exponentialRampToValueAtTime(0.0001, ctx.currentTime+start+dur);
      osc.connect(gain); gain.connect(ctx.destination);
      osc.start(ctx.currentTime+start);
      osc.stop(ctx.currentTime+start+dur+0.05);
    });
  } catch(e) {}
}
const sfx = {
  click:    ()=>playTone([[880,0,0.08]],'sine',0.12),
  cross:    ()=>playTone([[300,0,0.06],[200,0.04,0.1]],'triangle',0.2),
  win:      ()=>playTone([[523,0,.12],[659,.1,.12],[784,.2,.12],[1047,.3,.3],[1319,.45,.5]],'sine',0.22),
  lose:     ()=>playTone([[392,0,.12],[349,.12,.12],[294,.24,.25]],'triangle',0.18),
  ping:     ()=>playTone([[1200,0,.07],[900,.07,.12]],'sine',0.1),
  announce: ()=>playTone([[660,0,.06],[880,.06,.12]],'sine',0.15),
};

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   ROOM HELPERS
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
function genRoomId() {
  const chars='ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789';
  return Array.from({length:4},()=>chars[Math.floor(Math.random()*chars.length)]).join('');
}
function readDINGO() {
  playerName   = window.DINGO.playerName    || 'Player';
  playerAvatar = window.DINGO.selectedAvatar || 'ğŸ‘¹';
  playerColor  = window.DINGO.selectedColor  || '#00e5ff';
}

/* â”€â”€ Create Room â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
document.getElementById('create-btn').addEventListener('click', async () => {
  readDINGO(); sfx.click();
  const btn=document.getElementById('create-btn'), msg=document.getElementById('home-msg');
  btn.disabled=true; btn.textContent='â³ Creatingâ€¦'; msg.textContent='';
  try {
    roomId=genRoomId(); playerRole='p1';
    await set(ref(db,`rooms/${roomId}`),{
      players:{p1:myPlayerId},
      playerInfo:{p1:{name:playerName,avatar:playerAvatar,color:playerColor}},
      gameState:{status:'waiting',currentTurn:'p1',selectedNumbers:[0],winner:''},
      scores:{p1:0,p2:0}
    });
    document.getElementById('display-room-code').innerText=roomId;
    document.getElementById('waiting-label').innerText='Waiting for opponentâ€¦';
    initSetupBoard(); showScreen('setup'); showChat();
    onValue(ref(db,`rooms/${roomId}/playerInfo`),snap=>{
      const info=snap.val();
      if(info?.p2){document.getElementById('p2-name').textContent=info.p2.name;document.getElementById('p2-avatar').textContent=info.p2.avatar;document.getElementById('waiting-label').textContent=`${info.p2.name} joined!`}
      if(info?.p1){document.getElementById('p1-name').textContent=info.p1.name;document.getElementById('p1-avatar').textContent=info.p1.avatar}
    });
    onValue(ref(db,`rooms/${roomId}/scores`),snap=>{
      const s=snap.val();
      if(s){scores.p1=s.p1||0;scores.p2=s.p2||0;updateScoreDisplay()}
    });
  } catch(err){msg.textContent=`Error: ${err.message}`;console.error(err);}
  finally{btn.disabled=false;btn.textContent='ï¼‹  Create Room'}
});

/* â”€â”€ Join Room â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
document.getElementById('join-btn').addEventListener('click', async () => {
  readDINGO(); sfx.click();
  const btn=document.getElementById('join-btn'), msg=document.getElementById('home-msg');
  const code=document.getElementById('room-code-input').value.trim().toUpperCase();
  if(!code)return;
  btn.disabled=true; btn.textContent='â³'; msg.textContent='';
  try {
    const snap=await get(ref(db,`rooms/${code}`));
    if(snap.exists()&&!snap.val().players.p2){
      roomId=code; playerRole='p2';
      await update(ref(db,`rooms/${code}`),{
        'players/p2':myPlayerId,
        'playerInfo/p2/name':playerName,
        'playerInfo/p2/avatar':playerAvatar,
        'playerInfo/p2/color':playerColor,
      });
      const info=snap.val().playerInfo||{};
      document.getElementById('display-room-code').innerText=roomId;
      document.getElementById('p1-name').textContent=info.p1?info.p1.name:'P1';
      document.getElementById('p1-avatar').textContent=info.p1?info.p1.avatar:'ğŸ®';
      document.getElementById('p2-name').textContent=playerName;
      document.getElementById('p2-avatar').textContent=playerAvatar;
      document.getElementById('waiting-label').textContent='You joined!';
      initSetupBoard(); showScreen('setup'); showChat();
      onValue(ref(db,`rooms/${roomId}/scores`),s=>{
        const sc=s.val();if(sc){scores.p1=sc.p1||0;scores.p2=sc.p2||0;updateScoreDisplay()}
      });
    } else {
      msg.textContent=snap.exists()?'Room is full!':'Room not found!';
      setTimeout(()=>{msg.textContent=''},3000);
    }
  } catch(err){msg.textContent=`Error: ${err.message}`;console.error(err);}
  finally{btn.disabled=false;btn.textContent='Join'}
});

/* â”€â”€â”€ Score display â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
function updateScoreDisplay(){
  document.getElementById('score-p1').textContent=scores.p1;
  document.getElementById('score-p2').textContent=scores.p2;
}

/* â”€â”€â”€ Setup board â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
function initSetupBoard(){
  const bd=document.getElementById('setup-board');
  bd.innerHTML=''; myBoard=new Array(25).fill(null); setupCounter=1;
  document.getElementById('setup-progress').style.width='0%';
  document.getElementById('ready-btn').disabled=true;
  for(let i=0;i<25;i++){
    const cell=document.createElement('div');
    cell.className='cell'; cell.dataset.idx=i;
    cell.addEventListener('click',()=>placeNumber(cell,i));
    bd.appendChild(cell);
  }
}
function placeNumber(cell,idx){
  if(cell.dataset.filled||setupCounter>25)return;
  cell.textContent=setupCounter; cell.dataset.filled='true';
  myBoard[idx]=setupCounter; setupCounter++;
  sfx.click();
  document.getElementById('setup-progress').style.width=((setupCounter-1)/25*100)+'%';
  if(setupCounter>25)document.getElementById('ready-btn').disabled=false;
}
document.getElementById('shuffle-btn').addEventListener('click',()=>{
  sfx.click();
  const nums=Array.from({length:25},(_,i)=>i+1);
  for(let i=nums.length-1;i>0;i--){const j=Math.floor(Math.random()*(i+1));[nums[i],nums[j]]=[nums[j],nums[i]]}
  myBoard=[...nums]; setupCounter=26;
  document.querySelectorAll('#setup-board .cell').forEach((cell,i)=>{
    cell.textContent=nums[i]; cell.dataset.filled='true';
    cell.style.animation='none'; requestAnimationFrame(()=>{cell.style.animation=''});
  });
  document.getElementById('setup-progress').style.width='100%';
  document.getElementById('ready-btn').disabled=false;
});
document.getElementById('clear-btn').addEventListener('click',()=>{sfx.click();initSetupBoard()});

/* â”€â”€â”€ Ready â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
document.getElementById('ready-btn').addEventListener('click',async()=>{
  sfx.click();
  const btn=document.getElementById('ready-btn');
  btn.disabled=true; btn.textContent='â³ Waitingâ€¦';
  await update(ref(db,`rooms/${roomId}/boards`),{[playerRole]:myBoard});
  onValue(ref(db,`rooms/${roomId}/boards`),snap=>{
    const b=snap.val();
    if(b&&b.p1&&b.p2){update(ref(db,`rooms/${roomId}/gameState`),{status:'playing'});startGame()}
  });
});

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   NUMBER ANNOUNCEMENT
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
let announceTimer=null;
function showAnnouncement(num,callerName,isMe){
  sfx.announce();
  const bubble=document.getElementById('announce-bubble');
  bubble.classList.remove('pop','fade-out'); void bubble.offsetWidth;
  document.getElementById('announce-who').textContent=isMe?'YOU CALLED':callerName.toUpperCase();
  document.getElementById('announce-num').textContent=num;
  document.getElementById('announce-sub').textContent=isMe?'nicely done':'crosses it out';
  bubble.classList.add('pop');
  if(announceTimer)clearTimeout(announceTimer);
  announceTimer=setTimeout(()=>{bubble.classList.remove('pop');bubble.classList.add('fade-out')},1600);
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   START GAME
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
function startGame(){
  if(winShown)return; winShown=false;
  showScreen('game');
  const boardDiv=document.getElementById('game-board');
  boardDiv.innerHTML='';
  let lastLen=0;

  onValue(ref(db,`rooms/${roomId}/playerInfo`),snap=>{
    const info=snap.val()||{};
    if(info.p1){document.getElementById('p1-name').textContent=info.p1.name;document.getElementById('p1-avatar').textContent=info.p1.avatar}
    if(info.p2){document.getElementById('p2-name').textContent=info.p2.name;document.getElementById('p2-avatar').textContent=info.p2.avatar}
  });

  myBoard.forEach(num=>{
    const cell=document.createElement('div');
    cell.className='cell'; cell.textContent=num; cell.id=`cell-${num}`;
    cell.addEventListener('click',()=>handleNumberClick(num));
    boardDiv.appendChild(cell);
  });

  onValue(ref(db,`rooms/${roomId}/gameState`),snap=>{
    const state=snap.val(); if(!state)return;
    const turnText=document.getElementById('turn-indicator');
    document.getElementById('p1-box').classList.toggle('active-turn',state.currentTurn==='p1');
    document.getElementById('p2-box').classList.toggle('active-turn',state.currentTurn==='p2');

    if(state.winner&&!winShown){
      winShown=true;
      const iWon=state.winner===playerRole;
      if(iWon){scores[playerRole]++;update(ref(db,`rooms/${roomId}/scores`),{[playerRole]:scores[playerRole]})}
      if(state.selectedNumbers)checkAndHighlightWin(state.selectedNumbers);
      setTimeout(()=>showWinOverlay(iWon),500);
      turnText.innerText=''; return;
    }
    turnText.innerText=state.currentTurn===playerRole?'Your Turn!':"Opponent's Turnâ€¦";

    if(state.selectedNumbers){
      if(state.selectedNumbers.length>lastLen){
        const newNum=state.selectedNumbers[state.selectedNumbers.length-1];
        if(newNum!==0){
          const caller=state.currentTurn===playerRole?(playerRole==='p1'?'p2':'p1'):playerRole;
          get(ref(db,`rooms/${roomId}/playerInfo/${caller}/name`)).then(s=>{
            showAnnouncement(newNum,s.val()||'Opponent',caller===playerRole);
          });
        }
      }
      lastLen=state.selectedNumbers.length;
      state.selectedNumbers.forEach(num=>{
        if(num!==0){
          const c=document.getElementById(`cell-${num}`);
          if(c&&!c.classList.contains('crossed')){c.classList.add('crossed');sfx.cross()}
        }
      });
      checkAndHighlightWin(state.selectedNumbers);
    }
  });
}

/* â”€â”€â”€ Handle click â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
async function handleNumberClick(num){
  const stateRef=ref(db,`rooms/${roomId}/gameState`);
  const snap=await get(stateRef); const state=snap.val();
  if(state.currentTurn===playerRole&&!state.winner&&!state.selectedNumbers.includes(num)){
    await update(stateRef,{selectedNumbers:[...state.selectedNumbers,num],currentTurn:playerRole==='p1'?'p2':'p1'});
  }
}

/* â”€â”€â”€ Win check + highlight â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
function checkAndHighlightWin(sel){
  const hits=myBoard.map(n=>sel.includes(n)?1:0);
  let lines=0; const wi=new Set();
  for(let r=0;r<5;r++){const b=r*5,row=[b,b+1,b+2,b+3,b+4];if(row.every(i=>hits[i])){row.forEach(i=>wi.add(i));lines++}}
  for(let c=0;c<5;c++){const col=[c,c+5,c+10,c+15,c+20];if(col.every(i=>hits[i])){col.forEach(i=>wi.add(i));lines++}}
  [[0,6,12,18,24],[4,8,12,16,20]].forEach(d=>{if(d.every(i=>hits[i])){d.forEach(i=>wi.add(i));lines++}});
  wi.forEach(idx=>{const c=document.getElementById(`cell-${myBoard[idx]}`);if(c)c.classList.add('win-line')});
  if(lines>=5)update(ref(db,`rooms/${roomId}/gameState`),{winner:playerRole});
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   WIN OVERLAY
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
const winPhrases =['Domination! ğŸ‘‘','Flawless Victory! âš¡','You\'re on fire! ğŸ”¥','GG! Absolutely lethal ğŸ¯','Champion energy! ğŸ’'];
const losePhrases=['So closeâ€¦ Try again ğŸ’ª','Next time you\'ll have it!','Respect the grind ğŸ¤'];
function showWinOverlay(iWon){
  iWon?sfx.win():sfx.lose();
  document.getElementById('win-title-text').textContent=iWon?'ğŸ‰ YOU WIN!':'ğŸ˜¢ YOU LOSE';
  document.getElementById('win-subtitle-text').textContent=iWon
    ?winPhrases[Math.floor(Math.random()*winPhrases.length)]
    :losePhrases[Math.floor(Math.random()*losePhrases.length)];
  document.getElementById('win-overlay').classList.add('show');
  if(iWon)launchConfetti();
  startRematchCountdown(); updateScoreDisplay();
}

/* â”€â”€â”€ Rematch countdown â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
function startRematchCountdown(){
  const div=document.getElementById('rematch-countdown'),val=document.getElementById('countdown-val');
  let t=10; div.style.display='block'; val.textContent=t;
  if(countdownInterval)clearInterval(countdownInterval);
  countdownInterval=setInterval(()=>{val.textContent=--t;if(t<=0){clearInterval(countdownInterval);div.style.display='none';doRestart()}},1000);
  document.getElementById('countdown-cancel').onclick=()=>{clearInterval(countdownInterval);div.style.display='none'};
}

/* â”€â”€â”€ Confetti â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
function launchConfetti(){
  const canvas=document.getElementById('confetti-canvas'),ctx=canvas.getContext('2d');
  canvas.width=window.innerWidth; canvas.height=window.innerHeight;
  const cols=['#00e5ff','#ff3cac','#ffd166','#06ffa5','#ffffff','#ff6b6b'];
  const pieces=Array.from({length:200},()=>({
    x:Math.random()*canvas.width,y:Math.random()*canvas.height-canvas.height,
    w:6+Math.random()*8,h:10+Math.random()*14,
    c:cols[Math.floor(Math.random()*cols.length)],
    r:Math.random()*Math.PI*2,rd:(Math.random()-.5)*.2,
    vy:3+Math.random()*5,vx:(Math.random()-.5)*3
  }));
  let frame;
  (function draw(){
    ctx.clearRect(0,0,canvas.width,canvas.height);
    pieces.forEach(p=>{
      p.y+=p.vy;p.x+=p.vx;p.r+=p.rd;p.vy+=.08;
      if(p.y>canvas.height){p.y=-20;p.x=Math.random()*canvas.width}
      ctx.save();ctx.translate(p.x+p.w/2,p.y+p.h/2);ctx.rotate(p.r);
      ctx.fillStyle=p.c;ctx.globalAlpha=.85;ctx.fillRect(-p.w/2,-p.h/2,p.w,p.h);ctx.restore();
    });
    frame=requestAnimationFrame(draw);
  })();
  setTimeout(()=>{cancelAnimationFrame(frame);ctx.clearRect(0,0,canvas.width,canvas.height)},5000);
}

/* â”€â”€â”€ Restart / reset â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
async function doRestart(){
  if(countdownInterval)clearInterval(countdownInterval);
  winShown=false;
  document.getElementById('win-overlay').classList.remove('show');
  document.getElementById('rematch-countdown').style.display='none';
  document.querySelectorAll('.cell.win-line').forEach(c=>c.classList.remove('win-line'));
  await update(ref(db,`rooms/${roomId}/gameState`),{status:'waiting',currentTurn:'p1',selectedNumbers:[0],winner:''});
  await set(ref(db,`rooms/${roomId}/boards`),null);
  initSetupBoard(); showScreen('setup');
  const rb=document.getElementById('ready-btn');rb.disabled=true;rb.textContent="âœ“ I'm Ready!";
  sfx.click();
}
function doReset(){if(countdownInterval)clearInterval(countdownInterval);location.reload()}

document.getElementById('win-restart-btn').addEventListener('click',doRestart);
document.getElementById('win-reset-btn').addEventListener('click',doReset);
document.getElementById('restart-btn').addEventListener('click',doRestart);
document.getElementById('reset-btn').addEventListener('click',doReset);

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   CHAT SYSTEM
   â€” emoji + text
   â€” last message shown in the player's profile box
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
const CHAT_EMOJIS=['ğŸ‘','ğŸ”¥','ğŸ˜‚','ğŸ˜±','ğŸ¯','ğŸ’€','ğŸ†','ğŸ˜¤','ğŸ¤¯','ğŸ‘','ğŸ˜ˆ','ğŸ«¡'];

/* Update the little status line under a player's name */
function updatePlayerStatus(senderRole, text) {
  const el = document.getElementById(senderRole + '-status');
  if (!el) return;
  el.textContent = text.length > 22 ? text.slice(0,21)+'â€¦' : text;
  el.classList.add('visible');
  // Fade out after 6 seconds
  clearTimeout(el._fadeTimer);
  el._fadeTimer = setTimeout(()=>el.classList.remove('visible'), 6000);
}

function showChat(){
  document.getElementById('chat-fab').style.display='flex';
  const emojiBar=document.getElementById('chat-emojis');
  emojiBar.innerHTML='';
  CHAT_EMOJIS.forEach(em=>{
    const btn=document.createElement('button');
    btn.className='emoji-btn'; btn.textContent=em;
    btn.addEventListener('click',()=>{
      sendMessage(em,true);
      chatOpen=false;
      document.getElementById('chat-panel').classList.remove('open');
    });
    emojiBar.appendChild(btn);
  });

  onValue(ref(db,`rooms/${roomId}/chat`),snap=>{
    const msgs=snap.val(); if(!msgs)return;
    const container=document.getElementById('chat-messages');
    container.innerHTML='';
    const list=Object.values(msgs).slice(-40);
    list.forEach(m=>{
      const wrap=document.createElement('div');
      wrap.className='chat-msg'+(m.sender===playerRole?' mine':'');
      const bubble=document.createElement('div');
      bubble.className='chat-bubble'+(m.isEmoji?' emoji-only':'');
      bubble.textContent=m.text;
      const sender=document.createElement('div');
      sender.className='chat-sender'; sender.textContent=m.senderName;
      wrap.appendChild(bubble); wrap.appendChild(sender);
      container.appendChild(wrap);
    });
    container.scrollTop=container.scrollHeight;

    // Show last message in player status boxes
    if(list.length>0){
      const last=list[list.length-1];
      updatePlayerStatus(last.sender, last.text);
    }

    if(!chatOpen){
      document.getElementById('chat-badge').classList.add('show');
      sfx.ping();
    }
  });
}

async function sendMessage(text,isEmoji=false){
  if(!text.trim())return;
  await push(ref(db,`rooms/${roomId}/chat`),{text,isEmoji,sender:playerRole,senderName:playerName,ts:Date.now()});
}

document.getElementById('chat-send-btn').addEventListener('click',()=>{
  const input=document.getElementById('chat-text-input');
  const txt=input.value.trim();
  if(txt){sendMessage(txt,false);input.value='';chatOpen=false;document.getElementById('chat-panel').classList.remove('open')}
});
document.getElementById('chat-text-input').addEventListener('keydown',e=>{
  if(e.key==='Enter')document.getElementById('chat-send-btn').click();
});
document.getElementById('chat-fab').addEventListener('click',()=>{
  chatOpen=!chatOpen;
  document.getElementById('chat-panel').classList.toggle('open',chatOpen);
  if(chatOpen){document.getElementById('chat-badge').classList.remove('show');document.getElementById('chat-messages').scrollTop=9999}
});
</script>
</body>
</html>
